// Generated by CoffeeScript 1.8.0
(function() {
  var Bald, controller, inflection, manager;

  inflection = require('inflection');

  manager = require('./manager');

  controller = require('./controller');

  Bald = (function() {
    function Bald(_arg) {
      var app, sequelize;
      app = _arg.app, sequelize = _arg.sequelize;
      if ((app == null) || (sequelize == null) || arguments.length === 0) {
        throw new Error('Arguments invalid.');
      }
      this.app = app;
      this.sequelize = sequelize;
    }

    Bald.prototype.resource = function(_arg) {
      var eagerLoading, endpoints, middleware, model, modelManager, plural;
      model = _arg.model, endpoints = _arg.endpoints, middleware = _arg.middleware, eagerLoading = _arg.eagerLoading;
      if (model == null) {
        throw new Error('Invalid model.');
      }
      endpoints = endpoints || {};
      if ((endpoints.plural == null) && (endpoints.singular == null)) {
        plural = inflection.pluralize(model.name);
        endpoints = {
          plural: '/api/' + plural,
          singular: '/api/' + plural + '/:id'
        };
      }
      modelManager = manager(model, eagerLoading);
      controller(this.app, endpoints, modelManager, middleware);
      return modelManager;
    };

    return Bald;

  })();

  module.exports = Bald;

}).call(this);
