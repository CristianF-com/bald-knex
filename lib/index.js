// Generated by CoffeeScript 1.10.0
(function() {
  var Bald, BaldError, _, controller, inflect;

  inflect = require('inflect');

  _ = require('lodash');

  controller = require('./controller');

  BaldError = require('./error');

  Bald = (function() {
    function Bald(arg) {
      var app, bookshelf;
      app = arg.app, bookshelf = arg.bookshelf;
      if (app == null) {
        throw new BaldError('BaldInitializationError', 'Arguments invalid.');
      }
      this.app = app;
      this.bookshelf = bookshelf;
    }

    Bald.prototype.resource = function(arg) {
      var endpoints, middleware, model, name;
      model = arg.model, endpoints = arg.endpoints, middleware = arg.middleware;
      if (model == null) {
        throw new BaldError('BaldResourceError', 'Invalid model.');
      }
      endpoints = endpoints || {};
      if ((endpoints.plural == null) && (endpoints.singular == null)) {
        name = model.prototype.tableName;
        endpoints = {
          plural: '/api/' + inflect.pluralize(name),
          singular: '/api/' + inflect.singularize(name + '/:id')
        };
      }
      return controller(this.app, endpoints, model, middleware);
    };

    return Bald;

  })();

  module.exports = Bald;

}).call(this);
